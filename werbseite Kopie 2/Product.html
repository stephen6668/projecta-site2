<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Produkt — Projecta Armband</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      font-family: 'Inter', sans-serif;
      margin: 0;
      padding: 0;
      background: #f9f9f9;
      color: #333;
    }

    .product-gallery img {
      max-width: 50%;
      height: auto;
      display: block;
      margin: 0 auto;
    }

    .thumbs img {
      max-width: 80px;
      height: auto;
      cursor: pointer;
      margin-right: 8px;
      border-radius: 12px;
      transition: transform 0.2s ease;
    }

    .thumbs img:hover {
      transform: scale(1.05);
    }

    @media (max-width: 768px) {
      .product-gallery img {
        max-width: 80%;
      }
    }

    .product-box {
      background: #F2ECE4;
      padding: 2rem;
      border-radius: 16px;
      box-shadow: 0 6px 24px rgba(0,0,0,0.06);
      margin-top: 2rem;
      margin-bottom: 2rem;
    }

    .diamond-options {
      display: flex;
      flex-direction: column;
      gap: 1.2rem;
      margin-top: 2rem;
      padding: 1.5rem;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    }

    .diamond-options label {
      font-size: 1.1rem;
      font-weight: 600;
      margin-bottom: 0.3rem;
    }

    .diamond-options select,
    .diamond-options input[type="text"],
    .diamond-options input[type="number"] {
      font-size: 1rem;
      padding: 0.8rem 1rem;
      border-radius: 8px;
      border: 1px solid #ccc;
      background: #fff;
      width: 100%;
      box-shadow: 0 2px 6px rgba(0,0,0,0.03);
      transition: border-color 0.2s ease;
    }

    .diamond-options select:focus,
    .diamond-options input:focus {
      border-color: #0077cc;
      outline: none;
    }

    .btn-group {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 1rem;
    }

    .btn {
      padding: 0.8rem 1.4rem;
      font-size: 1rem;
      border-radius: 8px;
      cursor: pointer;
      border: none;
    }

    .btn-primary {
      background-color: #0077cc;
      color: #fff;
    }

    .btn-outline {
      background-color: transparent;
      border: 2px solid #0077cc;
      color: #0077cc;
    }

    .site-footer {
      background: #222;
      color: #fff;
      padding: 2rem 0;
    }

    .footer-inner {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 1rem;
    }

    .footer-links a {
      color: #fff;
      margin-left: 1rem;
      text-decoration: none;
    }

    /* Notification Styles */
    .cart-notification {
      position: fixed;
      top: 20px;
      right: 20px;
      background: #4CAF50;
      color: white;
      padding: 15px 20px;
      border-radius: 8px;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      z-index: 1000;
      font-weight: 600;
    }

    /* Cart Badge Styles */
    .cart-badge {
      position: absolute;
      top: -8px;
      right: -8px;
      background: #ff4444;
      color: white;
      border-radius: 50%;
      width: 20px;
      height: 20px;
      font-size: 12px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <header class="site-header">
    <div class="container header-inner">
      <a href="index.html" class="brand">
        <img src="images/Logo.png" alt="Projecta Logo" class="logo">
        <span class="brand-text">Projecta</span>
      </a>
      <nav id="main-nav" class="nav">
        <a href="index.html">Home</a>
        <a href="product.html" class="active">Produkt</a>
        <a href="cart.html" style="position: relative;">Warenkorb</a>
        <a href="about.html">Über Uns</a>
        <a href="contact.html">Kontakt</a>
        <a href="admin.html" class="admin-link">Admin</a>
        <a href="future-products.html">Zukünftige Produkte</a>
      </nav>
      <button id="burger" class="burger" aria-label="Menü"><span></span><span></span><span></span></button>
    </div>
  </header>

  <main class="container spaced">
    <section class="product-detail">
      <div class="product-gallery">
        <div class="main-image" id="main-image">
          <img id="zoom-image" src="images/produkt1.png" alt="Projecta Armband" />
        </div>
        <div class="thumbs" id="thumbs">
          <img src="images/produkt1.png" data-full="images/produkt1.png" alt="Thumbnail 1">
          <img src="images/produkt2.png" data-full="images/produkt2.png" alt="Thumbnail 2">
          <img src="images/produkt3.jpg" data-full="images/produkt3.jpg" alt="Thumbnail 3">
        </div>
      </div>

      <div class="product-info">
        <div class="product-box">
          <h1 id="product-title">Safty-Band</h1>
          <p class="price" id="product-price">€135.00</p>
          <p id="product-desc">Stylisch, leicht und einfach zu bedienen: Mit nur einem Knopfdruck sendet das Armband deinen Standort an festgelegte Kontakte und kann einen lauten Alarm auslösen – auch ohne Handy in der Nähe. Über die App siehst du den Akkustand und bekommst eine Warnung, wenn er fast leer ist.</p>

          <div class="diamond-options">
            <label for="quantity">Menge</label>
            <input id="quantity" type="number" min="1" value="1">

            <label for="diamond-form">Diamantform</label>
            <select id="diamond-form">
              <option value="rund">Rund</option>
              <option value="emerald">Emerald</option>
              <option value="heart">Heart</option>
              <option value="cushion">Cushion</option>
            </select>

            <label for="diamond-color">Diamantfarbe</label>
            <select id="diamond-color">
              <option value="blau-rot">Blau-Rot</option>
              <option value="grün-hellblau">Grün-Hellblau</option>
              <option value="gelb">Gelb</option>
              <option value="weiß-pink">Weiß-Pink</option>
              <option value="rot">Rot</option>
              <option value="lila-pink">Lila-Pink</option>
            </select>

            <label for="band-color">Armbandfarbe</label>
            <select id="band-color">
              <option value="silber">Silber</option>
              <option value="gold">Gold</option>
              <option value="rosegold">Roségold</option>
            </select>

            <label for="engraving">Gravur (optional)</label>
            <input type="text" id="engraving" placeholder="Dein Text (max. 20 Zeichen)" />

            <div class="btn-group">
              <button id="add-to-cart" class="btn btn-primary">In den Warenkorb</button>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="site-footer">
    <div class="container footer-inner">
      <div>© <span id="year"></span> Projecta — Alle Rechte vorbehalten.</div>
    </div>
  </footer>

  <!-- JavaScript -->
  <script>
    // Jahr im Footer setzen
    document.getElementById("year").textContent = new Date().getFullYear();

    // Thumbnail-Galerie
    document.querySelectorAll('#thumbs img').forEach(thumb => {
      thumb.addEventListener('click', function() {
        const fullImage = this.dataset.full;
        document.getElementById('zoom-image').src = fullImage;
      });
    });

    // In den Warenkorb Button
    document.getElementById("add-to-cart").addEventListener("click", function() {
      console.log("Button geklickt!"); // Debug-Ausgabe
      
      // Produktdaten sammeln
      const productTitle = document.getElementById("product-title").textContent.trim();
      const productPriceText = document.getElementById("product-price").textContent;
      const price = parseFloat(productPriceText.replace('€', '').replace(',', '.'));
      const quantity = parseInt(document.getElementById("quantity").value);
      const diamondForm = document.getElementById("diamond-form").value;
      const diamondColor = document.getElementById("diamond-color").value;
      const bandColor = document.getElementById("band-color").value;
      const engraving = document.getElementById("engraving").value.trim();
      const image = document.getElementById("zoom-image").src;

      // Validierung
      if (quantity < 1) {
        alert("Bitte wähle eine gültige Menge aus.");
        return;
      }

      if (engraving.length > 20) {
        alert("Die Gravur darf maximal 20 Zeichen lang sein.");
        return;
      }

      // Produkt-Objekt erstellen
      const product = {
        id: 'safty-band-' + Date.now(),
        name: productTitle,
        price: price,
        quantity: quantity,
        diamondForm: diamondForm,
        diamondColor: diamondColor,
        bandColor: bandColor,
        engraving: engraving,
        image: image
      };

      console.log("Produkt-Objekt:", product); // Debug-Ausgabe

      // Warenkorb aus localStorage laden
      let cart = [];
      try {
        const cartData = localStorage.getItem('projecta-cart');
        if (cartData) {
          cart = JSON.parse(cartData);
        }
      } catch (e) {
        console.error("Fehler beim Laden des Warenkorbs:", e);
        cart = [];
      }

      // Prüfen ob bereits ein ähnliches Produkt im Warenkorb ist
      const existingProductIndex = cart.findIndex(item =>
        item.name === product.name &&
        item.diamondForm === product.diamondForm &&
        item.diamondColor === product.diamondColor &&
        item.bandColor === product.bandColor &&
        item.engraving === product.engraving
      );

      if (existingProductIndex > -1) {
        // Produkt existiert bereits, Menge erhöhen
        cart[existingProductIndex].quantity += product.quantity;
        showNotification(`Menge von "${product.name}" wurde um ${product.quantity} erhöht!`);
      } else {
        // Neues Produkt hinzufügen
        cart.push(product);
        showNotification(`"${product.name}" wurde zum Warenkorb hinzugefügt!`);
      }

      // Warenkorb in localStorage speichern
      try {
        localStorage.setItem('projecta-cart', JSON.stringify(cart));
        console.log("Warenkorb gespeichert:", cart); // Debug-Ausgabe
      } catch (e) {
        console.error("Fehler beim Speichern des Warenkorbs:", e);
        alert("Fehler beim Speichern des Warenkorbs. Bitte versuchen Sie es erneut.");
        return;
      }

      // Warenkorb-Badge aktualisieren
      updateCartBadge();
    });

    // Funktion für Benachrichtigungen
    function showNotification(message) {
      // Bestehende Notification entfernen
      const existingNotification = document.querySelector('.cart-notification');
      if (existingNotification) {
        existingNotification.remove();
      }

      // Neue Notification erstellen
      const notification = document.createElement('div');
      notification.className = 'cart-notification';
      notification.textContent = message;

      document.body.appendChild(notification);

      // Nach 3 Sekunden entfernen
      setTimeout(() => {
        if (notification.parentNode) {
          notification.remove();
        }
      }, 3000);
    }

    // Warenkorb-Badge aktualisieren
    function updateCartBadge() {
      let cart = [];
      try {
        const cartData = localStorage.getItem('projecta-cart');
        if (cartData) {
          cart = JSON.parse(cartData);
        }
      } catch (e) {
        console.error("Fehler beim Laden des Warenkorbs für Badge:", e);
      }

      const totalItems = cart.reduce((sum, item) => sum + item.quantity, 0);
      
      // Badge finden oder erstellen
      let badge = document.querySelector('.cart-badge');
      const cartLink = document.querySelector('nav a[href="cart.html"]');
      
      if (!badge && totalItems > 0 && cartLink) {
        badge = document.createElement('span');
        badge.className = 'cart-badge';
        cartLink.appendChild(badge);
      }
      
      if (badge) {
        if (totalItems > 0) {
          badge.textContent = totalItems > 99 ? '99+' : totalItems;
          badge.style.display = 'flex';
        } else {
          badge.style.display = 'none';
        }
      }
    }

    // Badge beim Laden der Seite aktualisieren
    document.addEventListener('DOMContentLoaded', function() {
      console.log("Seite geladen, Badge wird aktualisiert");
      updateCartBadge();
    });

    // Burger-Menü (falls vorhanden)
    const burger = document.getElementById('burger');
    const nav = document.getElementById('main-nav');

    if (burger && nav) {
      burger.addEventListener('click', function() {
        nav.classList.toggle('active');
        burger.classList.toggle('active');
      });
    }

    // Test ob localStorage funktioniert
    try {
      localStorage.setItem('test', 'test');
      localStorage.removeItem('test');
      console.log("LocalStorage funktioniert");
    } catch (e) {
      console.error("LocalStorage funktioniert nicht:", e);
      alert("Ihr Browser unterstützt kein LocalStorage. Der Warenkorb funktioniert möglicherweise nicht korrekt.");
    }
  </script>
</body>
</html>
